<!DOCTYPE html>
<html>
<head>
	<title>Garry's Mod Lua Virus</title>
</head>
<body>

	<h1>You appear to be infected with a Garry's Mod Lua Virus</h1>

	<p>On 4/18/2014, a Lua virus was released in Garry's Mod.</p>

	<h2>How to remove it</h2>
	<p>To remove the virus, follow the following steps:</p>
	<ol>
		<li><p>Close Garry's Mod. The URL to this webpage is saved in your clipboard. Paste it into your browser's address bar.</p></li>
		<li>
			<p>
				Open up notepad and paste the following code inside. Alternatively <a href="javascript:downloadScript();">click to download the script</a>.
<pre id="batchScript" class="batch-script">
::Run from the "garrysmod" folder on either the client or server.

@echo off
title Exploit file cleanup - MFSiNC

if exist "hl2.exe" (
	cd "garrysmod"
)

if not exist steam.inf (
	echo.
	echo You're running this from the wrong place!
	echo.
	echo Put this file in your garrysmod folder, either server or client, and re-run it.
	echo.
	echo.
	pause
	exit
)

echo.
echo This will remove the files used in the exploit/virus.
echo.
echo To see exactly what will be removed, open this batch file with Notepad.
echo.
pause

echo Cleaning..

taskkill /F /IM hl2.exe > nul
taskkill /F /IM srcds.exe > nul



::Files, clientside
if exist "engine_win32.dll" (
	attrib -h "engine_win32.dll"
	del /F /Q "engine_win32.dll"	
)

if exist "materials\cooltexture.vtf" (
	del /F /Q "materials\cooltexture.vtf"
)

if exist "bin\game_shader_generic_engine.dll" (
	attrib -h "bin\game_shader_generic_engine.dll"
	del /F /Q "bin\game_shader_generic_engine.dll"
)

if exist "download\engine_win32.dll" (
	attrib -h "download\engine_win32.dll"
	del /F /Q "download\engine_win32.dll"
)

::Dir
if exist "download\cfg" (
	RD /S /Q "download\cfg"
)



::Files, serverside
if exist "lua\autorun\server\default.lua" (
	attrib -h "lua\autorun\server\default.lua"
	del /F /Q "lua\autorun\server\default.lua"
)



echo.
echo Done.
echo.
pause
</pre>
			</p>
		</li>
		<li>
			<p>Save it as <b>gmodfix.bat</b> in the garrysmod folder. Make sure <b>.txt</b> doesn't get appended to the filename.</p>
		</li>
		<li>
			<p>
				Run the file.
			</p>
		</li>
	</ol>
	<p>At this point, the virus should be removed. However, do not play on any Garry's Mod server that is infected. These can easily be spotted as they have "!!!" prefixed to their server name.</p>

	<h2>How did this happen?</h2>
	<p>
		You joined a server that was infected, the files were sent to you, stored in your Garry's Mod files and ran. More info can be found in the following thread on Facepunch: <a href="http://facepunch.com/showthread.php?t=1386818">http://facepunch.com/showthread.php?t=1386818</a>
	</p>

	<style type="text/css">
	body {
		background-color: #fff;
		width: 800px;
		margin: 0 auto;
	}

	.batch-script {
		display: block;
		background-color: #292121;
		color: #ececec;
		border-radius: 4px;
		padding: 10px;
		word-spacing: ;
	}
	</style>

	<script type="text/javascript">
	window.URL = window.webkitURL || window.URL;
	window.Blob = window.Blob || window.WebKitBlob || window.MozBlob;

	function downloadScript() {
		var text = document.getElementById('batchScript').innerHTML;
		var blob = new Blob([text], {type:'text/plain'});
		var filename = 'gmodfix.bat';

		var downloadLink = document.createElement('a');
		downloadLink.href = window.URL.createObjectURL(blob);
		downloadLink.download = filename;
		downloadLink.click();
	}
	</script>

</body>
</html>